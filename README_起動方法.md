# NPO法人助成金管理システム - 起動方法

## 🚀 簡単起動方法

### 方法1: バッチファイルで起動（推奨）
1. `アプリ起動.bat` をダブルクリック
2. 黒い画面（コマンドプロンプト）が開き、自動でシステムが起動します
3. 起動完了後、ブラウザで以下のURLにアクセス：
   - **このPCから**: http://localhost:8531
   - **社内の他のPCから**: 表示される社内共有用URLを使用

### 方法2: PowerShellスクリプトで起動
1. `アプリ起動.ps1` を右クリック → 「PowerShellで実行」
2. もしエラーが出る場合は、PowerShellを管理者権限で開いて以下を実行：
   ```powershell
   Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
   ```
3. その後、再度 `アプリ起動.ps1` を実行

## 💡 起動時の画面表示について

起動時に以下のような情報が表示されます：

```
========================================
  NPO法人助成金管理システム 起動中...
========================================

作業ディレクトリ: D:\Users\田中直子\cursor\予算管理アプリ
仮想環境をアクティベート中...
仮想環境アクティベート完了
パッケージの確認中...
パッケージ確認完了

アプリケーションを起動しています...

========================================
【アクセス方法】
・このPCから: http://localhost:8531
・社内の他のPCから: http://192.168.1.100:8531

🔗 社内共有用URL: http://192.168.1.100:8531
========================================

アプリを終了するには、このウィンドウでCtrl+Cを押してください。
```

## 📋 システム要件
- Windows 10以降
- Python 3.8以降
- 必要なパッケージ（requirements.txtに記載）

## 🎯 初回セットアップ

初回起動時は、以下のファイルが自動で作成されます：
- `transactions_data.csv` - 取引データ
- `grants_data.csv` - 助成金データ
- `allocations_data.csv` - 割り当てデータ

## 🛠️ 初回起動時の動作
- 仮想環境の自動アクティベート
- 必要なパッケージの自動インストール
- Streamlitアプリの起動

## 🔧 手動起動方法（参考）
```bash
# 1. 仮想環境をアクティベート
.\venv\Scripts\Activate.ps1

# 2. 必要なパッケージをインストール（初回のみ）
pip install -r requirements.txt

# 3. アプリを起動
streamlit run main.py
```

## 📝 使用方法
1. ブラウザでアプリが開いたら、サイドバーからメニューを選択
2. 「freee データアップロード」で取引データを読み込み
3. 「助成金予算管理」で助成金を設定
4. 「取引割り当て」で取引を助成金に割り当て
5. 「分析・レポート」で執行状況を確認

## ⚠️ 注意事項
1. **起動中のウィンドウは閉じないでください**
   - 黒い画面（コマンドプロンプト）が起動中は開いたままにしてください
   - このウィンドウを閉じると、アプリが終了します

2. **アプリを終了する場合**
   - 起動中のウィンドウで `Ctrl+C` を押してください
   - または、ウィンドウを閉じることでも終了できます

3. **社内の他のPCからアクセスする場合**
   - ファイアウォールの設定によってはアクセスできない場合があります
   - その場合は、ポート8531を許可するようファイアウォール設定を変更してください

## 🔧 トラブルシューティング

### 「仮想環境が見つかりません」エラーが出る場合
```cmd
python -m venv venv
```
を実行してから、再度起動してください。

### 「ポート8531が使用中」エラーが出る場合
1. 既に起動中のアプリがないか確認
2. タスクマネージャーでpython.exeプロセスを終了
3. 再度起動を試行

### PowerShellでの実行ポリシーエラー
PowerShellを管理者権限で開いて以下を実行：
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

## 📂 データファイル
- `transactions_data.csv` - 取引データ
- `grants_data.csv` - 助成金データ
- `allocations_data.csv` - 割り当てデータ 