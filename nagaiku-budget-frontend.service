[Unit]
Description=NPO Budget Management System - Frontend (çµ±ä¸€ç’°å¢ƒ)
After=network.target nagaiku-budget-backend.service
Wants=nagaiku-budget-backend.service

[Service]
Type=simple
User=tanaka
Group=tanaka
WorkingDirectory=/home/tanaka/nagaiku-budget/frontend
# çµ±ä¸€ç’°å¢ƒç”¨ç’°å¢ƒå¤‰æ•°è¨­å®š
Environment=PORT=3000
# .nextãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒãªã„å ´åˆã¯è‡ªå‹•ãƒ“ãƒ«ãƒ‰
ExecStartPre=/bin/bash -c 'if [ ! -d ".next" ]; then echo "ğŸ”¨ Building Next.js app..." && npm run build; else echo "âœ… Using existing build"; fi'
ExecStart=/usr/bin/npm start
Restart=always
RestartSec=10
StandardOutput=append:/home/tanaka/nagaiku-budget/logs/frontend_prod.log
StandardError=append:/home/tanaka/nagaiku-budget/logs/frontend_prod.log

# ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†
KillMode=mixed
KillSignal=SIGTERM
TimeoutStopSec=30

[Install]
WantedBy=multi-user.target 